---
title: "HostSwitch"
author: "Valeria Trivellone, Sabrina B.L. Araujo, Bernd Panassiti"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette for the HostSwitch package}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
abstract: "The 'HostSwitch' package uses a individual-based model to simulate the parasite's successful invasion and survival on a new host. As a consequence of such colonization, the parasite acquiring a new host adapts to a different resource which becomes an actual host. Recently, Araujo et al. (2015) introduced a mathematical model that evaluates the host switch of a parasite. The authors conceived the initial model to test the ...Here, we introduce the R package, HostSwitch which formalizes and extends the original model built on Fortran provided by Araujo et al. (2015). We describe the areas of application to increase the utility of the present simulation of the host switch under the ecological fitting hypotheses. Understanding Host-Switching by Ecological Fitting [https://doi.org/10.1371/journal.pone.0139225](https://doi.org/10.1371/journal.pone.0139225). The package provides an R-friendly and modified version of this model which can be applied to different host-parasite scenarios. \n \n \n"
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=8.5, fig.height=5.5, fig.align='center', warning=FALSE, message=FALSE, cache = T)
```

```{r setup,echo = F, message = F}
library(HostSwitch)
```

# Motivation 
The HostSwitch package offers simple functions to evaluate the role of the single parameters included in the model in defining the probability and the amplitude of the host switch. The extension in R code allows the users to choose among different host-parasite scenarios (S0, S1) described by the usage examples in this vignette.

HostSwitch has dependencies .....

This package will be expanded with furthers scenarios of species interaction. Please feel free to contact the authors to contribute by making suggestions, or sending bug fixes or extension proposals. 


# Theoratical background


# Using HostSwitch

## Installing, loading and citing the package

If you haven't installed the package yet, please install the recent release using GitHub

```{r}
#devtools::install_github(repo = "berndpanassiti/HostSwitch",build_vignettes = TRUE)
# NEED TO BE UNCOMMENTED when GITHUB repository public
```

Loading and citation

```{r}
library(HostSwitch)
citation("HostSwitch")
```


## Run the model
Simulate host switches by parasites
```{r}
# using only 20 generations and 1 iterations, others arguments left to default values
# see ?simHostSwitch for more arguments
simulated_quantities = simHostSwitch(seed=123,iter=1,n_generation=20) 
```

The function generates a list containing all quantities of interest which can be used for summary statistics or plots. Quantities of interest are **phenotpyes** of resource (original host, 'pRes_sim'), new resource (new host, 'pRes_new_sim') and of individual parasites ('pInd'). These parameters are available for each generation step.


Summary of host switches simulation
```{r}
summaryHostSwitch(simulated_quantities) 
```



## Plot the simulation of parasite host switches
```{r}
gg1 = plotHostSwitch(simulated_quantities, iter = 1) # use iter to select specific iterations
gg1
#gg1 + xlim(0,10) # limit x-axis from 0 to 10 generations
```


## Interactive plot using Shiny
```{r, eval=F}
shinyHostSwitch()
```

This function opens a new window with an interactive plot of the HostSwitch simulation model. This plot can be used to interact with the model and explore how different settings affect the host switches by a parasite.
