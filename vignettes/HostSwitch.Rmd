---
title: "HostSwitch"
author: "Valeria Trivellone, Sabrina B.L. Araujo, Bernd Panassiti"
date: 'created: 15.04.2021, last modified: `r format(Sys.Date(), format="%d.%m.%Y")`'
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette for the HostSwitch package}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}

header-includes:
  - \usepackage[document]{ragged2e}
  
bibliography: Literature.bib
biblio-style: "apalike"
link-citations: true

abstract: |
  \justifing
  
  The 'HostSwitch' package uses an individual-based model for simulating the consumer's successful invasion and survival on a novel host. As a consequence of such colonization,the consumer acquiring a new host adapts to a different resource which becomes an actual host. Recently, Araujo et al. [-@Araujo_2015] introduced a mathematical model that evaluates the host switch of a parasite. The authors conceived the initial model to test the ... 
  
  Here, we introduce the R package, HostSwitch which formalizes and extends the original model built on Fortran provided by Araujo et al. [-@Araujo_2015]. We describe the areas of application to increase the utility of the present simulation of the host switch under the ecological fitting hypotheses.  


  The package provides an R-friendly and modified version of this model which can be applied to different biological models and scenarios.\n\n\n
  

---

<style type="text/css">
h1  {
  margin-top: 1em;
}
h1.title {
  font-size: 38px;
  color: DarkBlue;
  text-align: center;
}

h4.author { /* Header 4 - and the author and data headers use this too  */
    font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: Black;
  text-align: center;
}
h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: Black;
  text-align: center;
}
</style>




```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=8.5, fig.height=5.5, fig.align='center', warning=FALSE, message=FALSE, cache = T)
```


# Theoratical background

[@Araujo_2015]


# Motivation 
The HostSwitch package offers simple functions to evaluate the role of the single parameters included in the model in defining the probability and the amplitude of the host switch. The extension in R code allows the users to choose among different consumer-host scenarios (S0, S1) described by the usage examples in this vignette.

HostSwitch has dependencies .....

This package will be expanded with furthers scenarios of species interaction. Please feel free to contact the authors to contribute by making suggestions, or sending bug fixes or extension proposals. 



# Using HostSwitch

## Installing, loading and citing the package

If you haven't installed the package yet, please install the recent release using GitHub

```{r, eval=FALSE}
devtools::install_github(repo = "berndpanassiti/HostSwitch",build_vignettes = TRUE)
```

Loading and citation

```{r}
library(HostSwitch)
citation("HostSwitch")
```




## Interactive plot using Shiny
```{r, eval=F}
shinyHostSwitch()
```

This function opens a new window with an interactive plot of the HostSwitch simulation model. This plot can be used to interact with the model and explore how different settings affect the host switches by a consumer.

## Run the model
### Simulate host switches by consumers
```{r}
# using only 20 generations and 1 simulation, others arguments left to default values
# see ?simHostSwitch for more arguments
simulated_quantities = simHostSwitch(seed=123,n_sim=1,n_generation=20) 
```

The function generates a list containing all quantities of interest which can be used for summary statistics or plots. Quantities of interest are **phenotpyes** of resource (original host, 'pRes_sim'), new resource (new host, 'pRes_new_sim') and of individual parasites ('pInd'). These parameters are available for each generation step.


### Summary of host switches simulation
```{r}
summaryHostSwitch(simulated_quantities) 
```



### Plot the simulation of parasite host switches
```{r}
gg1 = plotHostSwitch(simulated_quantities, sim_n = 1) # use n_sim to select a specific simulation
gg1
#gg1 + xlim(0,10) # limit x-axis from 0 to 10 generations
```


## Comparing two host switch simulations

To investigate the effect of selected parameters on host switches, the testHostSwitch function can be used to compare two simulations.


Here, we investigate how different number of offsprings (parameter b) affect the average number of jumps to a new host by a parasite.  
First, we create two simulations with different number of offsprings, leaving other paramters to default values. Note, to test for differences between simulations it is necessary to choose reasonable high number of simulations. We recommand for the number of jumps to set n_sim >= 100. Second, we compare both simulations choosing the parameter of interest and wether or not a boxplot should be drawn.
```{r}
# see ?simHostSwitch for more arguments
m1 = simHostSwitch(seed=123,n_sim=100,b=10) 
m2 = simHostSwitch(seed=123,n_sim=100,b=15) 

# see ?testHostSwitch for more arguments
testHostSwitch(simulated_quantities1=m1,simulated_quantities2=m2,parameter="j",test="t",plot=FALSE)
```


# References
